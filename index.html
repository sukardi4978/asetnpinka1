<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Aplikasi Aset</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #infoText { font-weight: bold; margin-bottom: 10px; }
    #runningText { 
      margin: 10px 0; 
      color: red; 
      white-space: nowrap;
      overflow: hidden;
      box-sizing: border-box;
      animation: running 15s linear infinite;
    }
    @keyframes running {
      0% { text-indent: 100%; }
      100% { text-indent: -100%; }
    }
    #searchBox { padding: 5px; width: 250px; }
    table { border-collapse: collapse; margin-top: 15px; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: left; }
    th { background: #f2f2f2; }
  </style>
</head>
<body>
  <!-- Tulisan diam -->
  <div id="infoText"></div>
  <!-- Running text -->
  <div id="runningText"></div>
  <!-- Kotak pencarian -->
  <input type="text" id="searchBox" placeholder="Cari aset...">
  <!-- Hasil pencarian -->
  <table id="resultTable">
    <thead>
      <tr>
        <th>Kode</th>
        <th>Nama Aset</th>
        <th>Lokasi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let sheetData = [];
    const searchBox = document.getElementById('searchBox');

    async function loadSheet() {
      const response = await fetch('data.json'); // sumber data JSON
      const data = await response.json();
      sheetData = data.values;

      // ambil data dari alamat sel
      const info = (sheetData[1] && sheetData[1][1]) ? sheetData[1][1] : '';   // B2
      const r2   = (sheetData[1] && sheetData[1][17]) ? sheetData[1][17] : ''; // R2

      document.getElementById('infoText').textContent = info;
      document.getElementById('runningText').textContent = r2;
    }

    // pencarian aset
    function searchAssets(keyword) {
      const tbody = document.querySelector('#resultTable tbody');
      tbody.innerHTML = '';
      if (!keyword) return;

      sheetData.forEach(row => {
        const kode  = row[0] || '';
        const nama  = row[1] || '';
        const lokasi = row[2] || '';

        if (kode.toLowerCase().includes(keyword.toLowerCase()) ||
            nama.toLowerCase().includes(keyword.toLowerCase()) ||
            lokasi.toLowerCase().includes(keyword.toLowerCase())) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${kode}</td><td>${nama}</td><td>${lokasi}</td>`;
          tbody.appendChild(tr);
        }
      });
    }

    // event pencarian (Enter)
    searchBox.addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        searchAssets(this.value);
      }
    });

    // klik pertama = select all, klik berikutnya = edit
    let firstClickDone = false;
    searchBox.addEventListener('click', function () {
      if (!firstClickDone) {
        this.select();
        firstClickDone = true;
      }
    });
    searchBox.addEventListener('blur', function () {
      firstClickDone = false;
    });

    // load data awal
    loadSheet();
  </script>
</body>
</html>
