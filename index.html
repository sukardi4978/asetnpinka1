<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Aplikasi Aset</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #infoText { font-weight: bold; margin-bottom: 10px; }
    #runningText {
      margin: 10px 0;
      color: red;
      white-space: nowrap;
      overflow: hidden;
      box-sizing: border-box;
      animation: running 15s linear infinite;
    }
    @keyframes running {
      0% { text-indent: 100%; }
      100% { text-indent: -100%; }
    }
    #searchBox { padding: 5px; width: 250px; }
    table { border-collapse: collapse; margin-top: 15px; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: left; }
    th { background: #f2f2f2; }
  </style>
</head>
<body>
  <!-- Tulisan diam dari B2 -->
  <div id="infoText"></div>
  <!-- Running text dari R2 -->
  <div id="runningText"></div>
  <!-- Kotak pencarian -->
  <input type="text" id="searchBox" placeholder="Cari aset...">
  <!-- Hasil pencarian -->
  <table id="resultTable">
    <thead>
      <tr>
        <th>Kode</th>
        <th>Nama Aset</th>
        <th>Lokasi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    let sheetData = [];
    const searchBox = document.getElementById('searchBox');

    async function loadSheet() {
      const response = await fetch('data.json'); // data dari file JSON
      const data = await response.json();
      sheetData = data.values;

      // ambil B2 (row index 1, col index 1) dan R2 (row index 1, col index 17)
      const b2 = sheetData[1]?.[1] || '';
      const r2 = sheetData[1]?.[17] || '';

      document.getElementById('infoText').textContent = b2;
      document.getElementById('runningText').textContent = r2;
    }

    // fungsi pencarian
    function searchAssets(keyword) {
      const tbody = document.querySelector('#resultTable tbody');
      tbody.innerHTML = '';
      if (!keyword) return;

      sheetData.forEach(row => {
        const kode   = row[0] || '';
        const nama   = row[1] || '';
        const lokasi = row[2] || '';

        if (
          kode.toLowerCase().includes(keyword.toLowerCase()) ||
          nama.toLowerCase().includes(keyword.toLowerCase()) ||
          lokasi.toLowerCase().includes(keyword.toLowerCase())
        ) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${kode}</td><td>${nama}</td><td>${lokasi}</td>`;
          tbody.appendChild(tr);
        }
      });
    }

    // Enter = pencarian
    searchBox.addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        searchAssets(this.value);
      }
    });

    // klik pertama select all, klik berikutnya edit
    let firstClick = false;
    searchBox.addEventListener('click', function () {
      if (!firstClick) {
        this.select();
        firstClick = true;
      }
    });
    searchBox.addEventListener('blur', function () {
      firstClick = false;
    });

    // load saat pertama
    loadSheet();
  </script>
</body>
</html>
