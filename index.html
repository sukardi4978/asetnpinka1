<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Aset Non Produksi PT INKA</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
    #hasil { margin-top: 20px; white-space: pre-wrap; text-align: left; display: inline-block; }
    input { padding: 8px; width: 250px; }
    button { padding: 8px; }
    #runningText {
      margin-top: 30px;
      background: #f0f0f0;
      padding: 10px;
      overflow: hidden;
      white-space: nowrap;
    }
    #runningText span {
      display: inline-block;
      padding-left: 100%;
      animation: scroll 15s linear infinite;
    }
    @keyframes scroll {
      0% { transform: translateX(0); }
      100% { transform: translateX(-100%); }
    }
    #infoText {
      margin-top: 15px;
      font-style: italic;
      color: gray;
    }
  </style>
</head>
<body>
  <h2>Aset Non Produksi PT INKA</h2>

  <input type="text" id="cari" placeholder="Masukkan Nomor Aset...">
  <button onclick="cariData()">üîç</button>

  <div id="hasil"></div>

  <div id="runningText"><span>Selamat datang di aplikasi Aset Non Produksi PT INKA</span></div>
  <div id="infoText">Gunakan kotak pencarian untuk mencari nomor aset.</div>

  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTafvAiaKbaQt2RIboLf9nY6v8mltXLhSN4R-l-LZGFmic1p0-83knr-g-bFEoPDB8Rl2T661YdYFTj/pub?gid=1753334008&single=true&output=csv";

    let dataAset = [];

    // Ambil data CSV dari Google Sheets
    fetch(sheetUrl)
      .then(response => {
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        return response.text();
      })
      .then(csvText => {
        dataAset = csvText.trim().split("\n").map(row => row.split(","));
        console.log("Data berhasil dimuat:", dataAset);
      })
      .catch(error => {
        document.getElementById("hasil").innerText = "Gagal memuat data: " + error;
      });

    // Fungsi pencarian aset
    function cariData() {
      const input = document.getElementById("cari").value.trim();
      const hasilDiv = document.getElementById("hasil");
      if (!input) {
        hasilDiv.innerText = "Masukkan nomor aset terlebih dahulu.";
        return;
      }

      const hasil = dataAset.filter(row => row[0] && row[0].toLowerCase().includes(input.toLowerCase()));

      if (hasil.length > 0) {
        hasilDiv.innerText = hasil.map(row => row.join(" | ")).join("\n");
      } else {
        hasilDiv.innerText = "Data aset tidak ditemukan.";
      }
    }
  </script>
</body>
</html>
