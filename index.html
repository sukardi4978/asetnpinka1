<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Aplikasi Aset</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    #runningText {
      white-space: nowrap;
      overflow: hidden;
      box-sizing: border-box;
      border: 1px solid #ccc;
      padding: 5px;
      margin-bottom: 10px;
    }
    #runningText span {
      display: inline-block;
      padding-left: 100%;
      animation: marquee 15s linear infinite;
    }
    @keyframes marquee {
      from { transform: translate(0, 0); }
      to { transform: translate(-100%, 0); }
    }
    #infoText {
      margin-bottom: 10px;
      font-weight: bold;
    }
    #searchBox {
      width: 300px;
      padding: 5px;
      margin-bottom: 10px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 8px; text-align: left; }
  </style>
</head>
<body>
  <!-- Tulisan diam -->
  <div id="infoText"></div>

  <!-- Running text -->
  <div id="runningText"><span></span></div>

  <!-- Kotak pencarian -->
  <input type="text" id="searchBox" placeholder="Cari aset...">

  <!-- Hasil pencarian -->
  <table id="resultTable">
    <thead>
      <tr>
        <th>Kode</th>
        <th>Nama Aset</th>
        <th>Lokasi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    async function loadSheet() {
      const response = await fetch('data.json'); // ganti sesuai sumber data
      const data = await response.json();
      const rows = data.values;

      // Ambil sesuai alamat sel
      const info = (rows[1] && rows[1][1]) ? rows[1][1] : '';   // B2
      const r2   = (rows[1] && rows[1][17]) ? rows[1][17] : ''; // R2

      // Tampilkan
      document.getElementById('infoText').textContent = info;
      document.querySelector('#runningText span').textContent = r2;

      // Simpan data tabel ke global
      window.sheetRows = rows;
    }

    // Behavior searchBox: klik pertama = select all, klik berikutnya = edit
    const searchBox = document.getElementById('searchBox');
    let firstClickDone = false;

    searchBox.addEventListener('click', function () {
      if (!firstClickDone) {
        this.select();        // pilih semua teks
        firstClickDone = true;
      }
    });
    searchBox.addEventListener('blur', function () {
      firstClickDone = false;
    });

    // Pencarian aset
    searchBox.addEventListener('keyup', function () {
      const keyword = this.value.toLowerCase();
      const tbody = document.querySelector('#resultTable tbody');
      tbody.innerHTML = '';

      if (!window.sheetRows) return;

      // Mulai dari baris ke-3 agar tidak bentrok header dan info
      window.sheetRows.slice(2).forEach(row => {
        const kode   = row[0] || '';
        const nama   = row[1] || '';
        const lokasi = row[2] || '';

        if (
          kode.toLowerCase().includes(keyword) ||
          nama.toLowerCase().includes(keyword) ||
          lokasi.toLowerCase().includes(keyword)
        ) {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${kode}</td><td>${nama}</td><td>${lokasi}</td>`;
          tbody.appendChild(tr);
        }
      });
    });

    // jalankan load
    loadSheet();
  </script>
</body>
</html>
