<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Aplikasi Percobaan</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .running-text {
      background: #003366; color: white; padding: 10px;
      white-space: nowrap; overflow: hidden; box-sizing: border-box;
    }
    .running-text span {
      display: inline-block; padding-left: 100%;
      animation: marquee 12s linear infinite;
    }
    @keyframes marquee {
      0% { transform: translateX(0%); }
      100% { transform: translateX(-100%); }
    }
    .info-text { margin: 15px 0; font-weight: bold; }
  </style>
</head>
<body>
  <!-- Running Text -->
  <div class="running-text">
    <span id="runningText">Memuat running text...</span>
  </div>

  <!-- Info Text -->
  <div class="info-text" id="infoText">Memuat info text...</div>

  <!-- Tabel Data -->
  <table border="1" cellpadding="5" cellspacing="0">
    <thead>
      <tr>
        <th>No</th>
        <th>No Aset</th>
        <th>Nama Aset</th>
        <th>Nilai</th>
        <th>Akun</th>
      </tr>
    </thead>
    <tbody id="dataTable"></tbody>
  </table>

  <script>
    // URL CSV
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTafvAiaKbaQt2RIboLf9nY6v8mltXLhSN4R-l-LZGFmic1p0-83knr-g-bFEoPDB8Rl2T661YdYFTj/pub?gid=1753334008&single=true&output=csv";

    // Atur teks manual sesuai keinginan
    document.getElementById("runningText").textContent = "Percobaan Aplikasi…";
    document.getElementById("infoText").textContent = "Selasa Kliwon, 26 Agustus 2025…";

    // Fungsi parsing CSV
    function parseCSV(text) {
      const rows = text.split("\n").map(r => r.split(","));
      return rows;
    }

    // Ambil data CSV dan tampilkan ke tabel
    fetch(csvUrl)
      .then(res => res.text())
      .then(csv => {
        const data = parseCSV(csv);
        const tbody = document.getElementById("dataTable");
        data.slice(1).forEach((row, i) => {
          if (row.length >= 5) {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${i+1}</td>
              <td>${row[0]}</td>
              <td>${row[1]}</td>
              <td>${row[2]}</td>
              <td>${row[3]}</td>
            `;
            tbody.appendChild(tr);
          }
        });
      })
      .catch(err => {
        console.error("Gagal memuat CSV", err);
      });
  </script>
</body>
</html>
